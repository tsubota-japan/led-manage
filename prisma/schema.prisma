generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model File {
  id         String      @id @default(cuid())
  name       String
  path       String      @unique
  mimeType   String
  size       Int
  createdAt  DateTime    @default(now())
  groupFiles GroupFile[]
}

model Group {
  id         String      @id @default(cuid())
  name       String
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
  groupFiles GroupFile[]
  schedules  Schedule[]
}

model GroupFile {
  id       String  @id @default(cuid())
  groupId  String
  fileId   String
  order    Int
  duration Int?
  group    Group   @relation(fields: [groupId], references: [id], onDelete: Cascade)
  file     File    @relation(fields: [fileId], references: [id], onDelete: Cascade)

  @@index([groupId, order])
}

model Schedule {
  id        String   @id @default(cuid())
  groupId   String
  startTime DateTime
  repeat    String   @default("none")
  priority  Int      @default(0)
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  group     Group    @relation(fields: [groupId], references: [id], onDelete: Cascade)
}

model Display {
  id        String   @id @default(cuid())
  name      String
  code      String   @unique
  createdAt DateTime @default(now())
}
